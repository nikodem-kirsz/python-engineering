[2023-10-14T11:35:15.404+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: bigquery_data_load.create_table manual__2023-10-14T11:35:09.401651+00:00 [queued]>
[2023-10-14T11:35:15.409+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: bigquery_data_load.create_table manual__2023-10-14T11:35:09.401651+00:00 [queued]>
[2023-10-14T11:35:15.409+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2023-10-14T11:35:15.409+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 1
[2023-10-14T11:35:15.410+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2023-10-14T11:35:15.416+0000] {taskinstance.py:1300} INFO - Executing <Task(BigQueryExecuteQueryOperator): create_table> on 2023-10-14 11:35:09.401651+00:00
[2023-10-14T11:35:15.420+0000] {standard_task_runner.py:55} INFO - Started process 1284 to run task
[2023-10-14T11:35:15.423+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'bigquery_data_load', 'create_table', 'manual__2023-10-14T11:35:09.401651+00:00', '--job-id', '20', '--raw', '--subdir', 'DAGS_FOLDER/bigquery_data_load.py', '--cfg-path', '/tmp/tmpq5cnoxaz']
[2023-10-14T11:35:15.425+0000] {standard_task_runner.py:83} INFO - Job 20: Subtask create_table
[2023-10-14T11:35:15.467+0000] {task_command.py:388} INFO - Running <TaskInstance: bigquery_data_load.create_table manual__2023-10-14T11:35:09.401651+00:00 [running]> on host 4c2fe63b7c62
[2023-10-14T11:35:15.510+0000] {taskinstance.py:1509} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Niko
AIRFLOW_CTX_DAG_ID=bigquery_data_load
AIRFLOW_CTX_TASK_ID=create_table
AIRFLOW_CTX_EXECUTION_DATE=2023-10-14T11:35:09.401651+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-10-14T11:35:09.401651+00:00
[2023-10-14T11:35:15.511+0000] {bigquery.py:1077} INFO - Executing: '
        SELECT * except (rank)
        FROM (
            SELECT
                *,
                ROW_NUMBER() OVER (
                    PARTITION BY vehicle_id ORDER BY DATE_TIME(date, TIME(hour, minute, 0)) DESC
                ) as rank
            FROM `***-400718.vehicle_analytics.history`) as latest
        WHERE rank = 1;
        
[2023-10-14T11:35:15.511+0000] {base.py:73} INFO - Using connection ID 'google_cloud_default' for task execution.
[2023-10-14T11:35:15.513+0000] {logging_mixin.py:137} WARNING - /home/***/.local/lib/python3.7/site-packages/***/providers/google/cloud/hooks/bigquery.py:2051 DeprecationWarning: This method is deprecated. Please use `BigQueryHook.insert_job` method.
[2023-10-14T11:35:15.514+0000] {credentials_provider.py:323} INFO - Getting connection using `google.auth.default()` since no key file is defined for hook.
[2023-10-14T11:35:15.517+0000] {bigquery.py:1542} INFO - Inserting job ***_1697283315516709_32e43621122890e979c7b27a57d1ed25
[2023-10-14T11:35:16.210+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/google/cloud/operators/bigquery.py", line 1103, in execute
    encryption_configuration=self.encryption_configuration,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 2185, in run_query
    job = self.insert_job(configuration=configuration, project_id=self.project_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/google/common/hooks/base_google.py", line 462, in inner_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/google/cloud/hooks/bigquery.py", line 1548, in insert_job
    job.result(timeout=timeout, retry=retry)
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/bigquery/job/query.py", line 1499, in result
    do_get_result()
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/bigquery/job/query.py", line 1489, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/bigquery/job/base.py", line 725, in result
    self._begin(retry=retry, timeout=timeout)
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/bigquery/job/query.py", line 1298, in _begin
    super(QueryJob, self)._begin(client=client, retry=retry, timeout=timeout)
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/bigquery/job/base.py", line 518, in _begin
    timeout=timeout,
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/bigquery/client.py", line 782, in _call_api
    return call()
  File "/home/airflow/.local/lib/python3.7/site-packages/google/api_core/retry.py", line 288, in retry_wrapped_func
    on_error=on_error,
  File "/home/airflow/.local/lib/python3.7/site-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/home/airflow/.local/lib/python3.7/site-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/airflow-400718/jobs?prettyPrint=false: Invalid dataset ID "vehicle-analytics". Dataset IDs must be alphanumeric (plus underscores) and must be at most 1024 characters long.

Location: None
Job ID: airflow_1697283315516709_32e43621122890e979c7b27a57d1ed25


Location: None
Job ID: airflow_1697283315516709_32e43621122890e979c7b27a57d1ed25

[2023-10-14T11:35:16.225+0000] {taskinstance.py:1323} INFO - Marking task as FAILED. dag_id=bigquery_data_load, task_id=create_table, execution_date=20231014T113509, start_date=20231014T113515, end_date=20231014T113516
[2023-10-14T11:35:16.242+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 20 for task create_table (400 POST https://bigquery.googleapis.com/bigquery/v2/projects/airflow-400718/jobs?prettyPrint=false: Invalid dataset ID "vehicle-analytics". Dataset IDs must be alphanumeric (plus underscores) and must be at most 1024 characters long.

Location: None
Job ID: airflow_1697283315516709_32e43621122890e979c7b27a57d1ed25


Location: None
Job ID: airflow_1697283315516709_32e43621122890e979c7b27a57d1ed25
; 1284)
[2023-10-14T11:35:16.265+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2023-10-14T11:35:16.283+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
